<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="/favicon.png" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dialtone Dashboard</title>

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&family=IBM+Plex+Mono:wght@300;400;600&display=swap"
    rel="stylesheet">
  <!-- Xterm CSS -->
  <link rel="stylesheet" href="/node_modules/@xterm/xterm/css/xterm.css" />
</head>

<body>
  <!-- Helper overlay for notifications just in case -->
  <div id="notification-overlay"></div>

  <!-- Main Grid Container -->
  <div class="grid-container">

    <!-- LEFT COLUMN: Terminal & Commands -->
    <section class="panel-left">
      <header class="panel-header">
        <h2>CMD // LOGS</h2>
        <div id="ui-version" class="mono" style="font-size: 10px; opacity: 0.5; margin-left: 10px;">v1.1.1</div>
        <div class="status-indicator" id="conn-status">OFFLINE</div>
      </header>

      <div id="terminal-container"></div>

      <div class="command-palette">
        <h3>Quick Commands</h3>
        <div class="btn-grid">
          <button id="btn-arm" class="btn btn-danger">ARM</button>
          <button id="btn-disarm" class="btn btn-warning">DISARM</button>
          <button id="btn-manual" class="btn">MANUAL</button>
          <button id="btn-guided" class="btn">GUIDED</button>
        </div>
        <div class="input-group">
          <input type="text" id="cmd-input" placeholder=">> Send Manual Command..." />
        </div>
      </div>
    </section>

    <!-- CENTER COLUMN: Video on top, 3D Visualization below -->
    <section class="panel-center">
      <div class="camera-feed-container-main">
        <img id="camera-feed" src="/stream" alt="No Feed" onerror="this.parentElement.classList.add('no-signal')" />
        <div class="cam-overlay">CAM 1 - YUYV</div>
      </div>

      <div id="three-container">
        <div id="hud-overlay">
          <div class="hud-top">
            <div class="hud-stat">ALT: <span id="hud-alt">0.0</span>m</div>
            <div class="hud-stat">SPD: <span id="hud-spd">0.0</span>m/s</div>
          </div>
          <div class="hud-center">
            <div class="hud-mode" id="hud-mode">STABILIZE</div>
          </div>
        </div>
        <!-- Canvas injected by Three.js -->
      </div>
    </section>

    <!-- RIGHT COLUMN: Telemetry & Alerts -->
    <section class="panel-right">
      <header class="panel-header">
        <h2>TELEMETRY // ALERTS</h2>
      </header>

      <div class="telemetry-box">
        <h3>Telemetry Stream</h3>
        <table class="telemetry-table">
          <tr>
            <th>HEARTBEAT</th>
            <td id="val-heartbeat" class="mono">--</td>
          </tr>
          <tr>
            <th>BATTERY</th>
            <td id="val-batt" class="mono">-- V</td>
          </tr>
          <tr>
            <th>GPS SATS</th>
            <td id="val-sats" class="mono">--</td>
          </tr>
          <tr>
            <th>LATITUDE</th>
            <td id="val-lat" class="mono">--</td>
          </tr>
          <tr>
            <th>LONGITUDE</th>
            <td id="val-lon" class="mono">--</td>
          </tr>
          <tr>
            <th>ROLL/PITCH</th>
            <td id="val-rp" class="mono">-- / --</td>
          </tr>
          <tr>
            <th>YAW (HDG)</th>
            <td id="val-yaw" class="mono">--</td>
          </tr>
          <tr>
            <th>NATS MSGS</th>
            <td id="val-nats" class="mono">0</td>
          </tr>
        </table>
      </div>

      <div class="system-logs-mini">
        <h3>Recent Alerts</h3>
        <ul id="alert-feed">
          <!-- Dynamic alerts -->
        </ul>
      </div>

    </section>

  </div>

  <!-- VPN MODE CONTAINER (Hidden by default) -->
  <div id="vpn-mode-container" class="vpn-container" style="display: none;">
    <div class="vpn-card">
      <header class="vpn-header">
        <h2>DIALTONE // VPN STATUS</h2>
        <div class="status-indicator online">ACTIVE</div>
      </header>

      <div class="vpn-details">
        <div class="vpn-row">
          <span class="label">HOSTNAME</span>
          <span class="value mono" id="vpn-hostname">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">IP ADDRESS</span>
          <span class="value mono" id="vpn-ip">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">STATE DIR</span>
          <span class="value mono" id="vpn-state-dir">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">UPTIME</span>
          <span class="value mono" id="vpn-uptime">--</span>
        </div>
      </div>

      <div class="vpn-footer">
        <p>This node is running in lightweight VPN mode.</p>
        <p>Only networking services are active.</p>
      </div>
    </div>
  </div>

  <!-- VPN MODE CONTAINER (Hidden by default) -->
  <div id="vpn-mode-container" class="vpn-container" style="display: none;">
    <div class="vpn-card">
      <header class="vpn-header">
        <h2>DIALTONE // VPN STATUS</h2>
        <div class="status-indicator online">ACTIVE</div>
      </header>

      <div class="vpn-details">
        <div class="vpn-row">
          <span class="label">HOSTNAME</span>
          <span class="value mono" id="vpn-hostname">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">IP ADDRESS</span>
          <span class="value mono" id="vpn-ip">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">STATE DIR</span>
          <span class="value mono" id="vpn-state-dir">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">PLATFORM</span>
          <span class="value mono" id="vpn-platform">--</span>
        </div>
        <div class="vpn-row">
          <span class="label">UPTIME</span>
          <span class="value mono" id="vpn-uptime">--</span>
        </div>
      </div>

      <div class="vpn-footer">
        <p>This node is running in lightweight VPN mode.</p>
        <p>Only networking services are active.</p>
      </div>
    </div>
  </div>

  <script type="module" src="/src/main.ts"></script>
</body>

</html>